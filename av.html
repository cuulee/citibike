<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title></title>
    <script src='js/d3.min.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.15.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<style>
body {
    background: #000;
}
#content {
  max-width: 480px;
}

</style>

<div id='content'></div>

<script>
var data = [];
var colors = ['#eeeeee', '#4A90E2', '#F5A623', '#50E3C2'];

var svg = d3.select("#content").append("svg")
    .attr("width", 1200)
    .attr("height", 960);

var line = d3.svg.line()
      .x(function(d,i) {
        return i*40; })
      .y(function(d,i) { return (300 - d*200); })
      .interpolate("basis");

var offset = 480, scale = 200;

var lineHours = d3.svg.line()
    .x(function(d,i) {
        var ang = -1*(360*((i)/24)+90)*(Math.PI/180);
        return offset+Math.cos(ang)*(d*scale);
    })
    .y(function(d,i) {
        var ang = -1*(360*((i)/24)+90)*(Math.PI/180);
        return offset+Math.sin(ang)*(d*scale);
      })
      .interpolate("basis");



d3.csv('data/open_matrix.csv', function(csv) {
  csv.forEach(function(r) {
    //import data
    var h = [];
    for(i = 0; i < 24; i++) {
      h.push(Math.round(+r[i]*1000)/1000);
    }
    data[r.sid] = {
      c: +r.cluster,
      h: h,
      id: +r.sid
    };
  });
  console.log(data);
  for(k in data) {

    svg.append("svg:path")
      .attr("fill", "none")
      .style("stroke", colors[data[k].c])
      .style("opacity", 1)
      .style("stroke-width", 0.1)
      .attr("id", k)
      .attr("d", function() {
      //  data[k].h.push(data[k].h[0])
        return line(data[k].h) })
  }

});

</script>

</body>
</html>
